import React, { useEffect } from 'react';
import { FeedInfoUI } from '../../components/ui/feed-info/feed-info';
import { useAppDispatch, useAppSelector } from '../../services/hooks';
import {
  publicOrdersActions,
  selectPublicOrders,
  selectPublicTotals,
  selectPublicReadyNumbers,
  selectPublicPendingNumbers,
} from '../../services/orders/publicOrders.slice';

const FEED_WS = 'wss://norma.nomoreparties.space/orders/all';

const FeedPage: React.FC = () => {
  const dispatch = useAppDispatch();

  // Connect once, disconnect on unmount
  useEffect(() => {
    dispatch(publicOrdersActions.connect(WS_PUBLIC));
    return () => {
      dispatch(publicOrdersActions.disconnect());
    };
  }, [dispatch]);

  // (orders) â€” keep if you render the list on the left
  const orders = useAppSelector(selectPublicOrders);
  const totals = useAppSelector(selectPublicTotals);
  const ready = useAppSelector(selectPublicReadyNumbers);
  const pending = useAppSelector(selectPublicPendingNumbers);

  return (
    <main className='page'>
      {/* Example: <OrdersList orders={orders} /> */}
      <FeedInfoUI feed={totals} readyOrders={ready} pendingOrders={pending} />
    </main>
  );
};

export default FeedPage;
