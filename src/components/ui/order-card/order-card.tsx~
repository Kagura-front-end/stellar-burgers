import React, { FC } from 'react';
import { Link, useLocation } from 'react-router-dom';
import { CurrencyIcon, FormattedDate } from '@zlden/react-developer-burger-ui-components';
import styles from './order-card.module.css';
import type { OrderCardUIProps } from './type';
import { OrderStatus } from '@components';

export const OrderCardUI: FC<OrderCardUIProps> = ({ order }) => {
  const location = useLocation();

  // Временная заглушка для отображения - нужно будет реализовать логику
  const ingredientsToShow = order.ingredients.slice(0, 6); // Показать первые 6 ингредиентов
  const remains = order.ingredients.length - 6; // Остальные ингредиенты
  const total = 999; // Временное значение, нужно будет рассчитать

  return (
    <Link
      to={order.number.toString()}
      relative='path'
      state={{ background: location }}
      className={`p-6 mb-4 mr-2 ${styles.order}`}
    >
      <div className={styles.order_info}>
        <span className={`text text_type_digits-default ${styles.number}`}>
          #{String(order.number).padStart(6, '0')}
        </span>
        <span className='text text_type_main-default text_color_inactive'>
          <FormattedDate date={new Date(order.createdAt)} />
        </span>
      </div>
      <h4 className={`pt-6 text text_type_main-medium ${styles.order_name}`}>{order.name}</h4>
      {location.pathname === '/profile/orders' && <OrderStatus status={order.status} />}
      <div className={`pt-6 ${styles.order_content}`}>
        <ul className={styles.ingredients}>
          {ingredientsToShow.map((ingredientId, index) => {
            let zIndex = 6 - index;
            let right = 20 * index;
            return (
              <li className={styles.img_wrap} style={{ zIndex: zIndex, right: right }} key={index}>
                <img
                  style={{
                    opacity: remains > 0 && 6 === index + 1 ? '0.5' : '1',
                  }}
                  className={styles.img}
                  src={'/images/ingredient-placeholder.png'} // Временный placeholder
                  alt='Ingredient'
                />
                {6 === index + 1 && remains > 0 ? (
                  <span className={`text text_type_digits-default ${styles.remains}`}>
                    +{remains}
                  </span>
                ) : null}
              </li>
            );
          })}
        </ul>
        <div>
          <span className={`text text_type_digits-default pr-1 ${styles.order_total}`}>
            {total}
          </span>
          <CurrencyIcon type='primary' />
        </div>
      </div>
    </Link>
  );
};

export default OrderCardUI;
