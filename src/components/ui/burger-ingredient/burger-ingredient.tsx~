import { FC, SyntheticEvent } from 'react';
import type { TIngredient } from '@utils-types';
import { Counter, CurrencyIcon, AddButton } from '@zlden/react-developer-burger-ui-components';
import { Link, type Location } from 'react-router-dom';
import styles from './burger-ingredient.module.css';

export type TBurgerIngredientProps = {
  ingredient: TIngredient;
  count: number;
  handleAdd?: () => void;
  /** Optional state for opening details in a modal route */
  locationState?: { background: Location } | undefined;
};

export const BurgerIngredient: FC<TBurgerIngredientProps> = ({
  ingredient,
  count,
  handleAdd,
  locationState,
}) => {
  const { _id, image, name, price } = ingredient;

  const onAddClick = (_e: SyntheticEvent) => {
    handleAdd?.();
  };

  const linkContent = (
    <>
      {!!count && <Counter count={count} size='default' />}
      <img className={styles.image} src={image} alt={name} />
      <div className={`${styles.price} mt-1 mb-1`}>
        <p className='text text_type_digits-default mr-2'>{price}</p>
        <CurrencyIcon type='primary' />
      </div>
      <p className={`${styles.title} text text_type_main-default`}>{name}</p>
    </>
  );

  const regularContent = (
    <>
      {!!count && <Counter count={count} size='default' />}
      <img className={styles.image} src={image} alt={name} />
      <div className={`${styles.price} mt-1 mb-1`}>
        <p className='text text_type_digits-default mr-2'>{price}</p>
        <CurrencyIcon type='primary' />
      </div>
      <p className={`${styles.title} text text_type_main-default`}>{name}</p>
    </>
  );

  return (
    <article className={styles.card}>
      {locationState ? (
        <Link to={`/ingredients/${_id}`} state={locationState} className={styles.linkArea}>
          {linkContent}
        </Link>
      ) : (
        regularContent
      )}

      <AddButton text='Добавить' onClick={onAddClick} />
    </article>
  );
};

export default BurgerIngredient;
